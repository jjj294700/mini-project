{% extends "page_modules/base.html" %}

{% block content %}
<!--begin::Horizontal Form-->
<div class="card card-warning card-outline mb-4">
  <!--begin::Header-->
  <div class="card-header">
    <div class="card-title">암 위험도 설문조사</div>
  </div>
  <!--end::Header-->

  <!--begin::Form-->
  <form action="{{ url_for('survey.survey_form') }}" method="post">
    <!--begin::Body-->
    <div class="card-body">
      <!-- 이름 -->
      <div class="row mb-3">
        <label for="name" class="col-sm-2 col-form-label">이름</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="name" name="name" placeholder="이름을 입력하세요" required>
        </div>
      </div>

      <!-- 성별 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">성별</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="male" name="gender" value="male" required>
            <label class="form-check-label" for="male">남</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="female" name="gender" value="female" required>
            <label class="form-check-label" for="female">여</label>
          </div>
        </div>
      </div>

      <!-- 나이 -->
      <div class="row mb-3">
        <label for="age" class="col-sm-2 col-form-label">나이</label>
        <div class="col-sm-10">
          <input type="number" class="form-control" id="age" name="age" required min="1" max="120" placeholder="나이를 입력해주세요">
        </div>
      </div>
      
      <!-- 직업 -->
      <div class="row mb-3">
        <label for="occupation" class="col-sm-2 col-form-label">직업</label>
        <div class="col-sm-10">
          <select class="form-control" id="occupation" name="occupation" required>
            <option value="">직업을 선택하세요</option>
            <option value="전문직">전문직</option>
            <option value="자유업">자유업</option>
            <option value="회사원">회사원</option>
            <option value="교사">교사</option>
            <option value="무직">무직</option>
            <option value="학생">학생</option>
            <option value="주부">주부</option>
            <option value="기타">기타</option>
          </select>
        </div>
      </div>

      <!-- 음주 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">음주 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="alcohol_yes" name="alcohol" value="yes" required>
            <label class="form-check-label" for="alcohol_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="alcohol_no" name="alcohol" value="no" required>
            <label class="form-check-label" for="alcohol_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 음주량 -->
      <div class="row mb-3" id="drinking_amount_div" style="display:none;">
        <label for="drinking_amount" class="col-sm-2 col-form-label">음주량 (병 수)</label>
        <div class="col-sm-10">
          <input type="number" class="form-control" id="drinking_amount" name="drinking_amount" step="0.1">
        </div>
      </div>

      <!-- 현재 흡연 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">현재 흡연 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="smoking_now_yes" name="smoking_now" value="yes" required>
            <label class="form-check-label" for="smoking_now_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="smoking_now_no" name="smoking_now" value="no" required>
            <label class="form-check-label" for="smoking_now_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 흡연량 -->
      <div class="row mb-3" id="smoking_amount_div" style="display:none;">
        <label for="smoking_amount" class="col-sm-2 col-form-label">흡연량 (개비 수)</label>
        <div class="col-sm-10">
          <input type="number" class="form-control" id="smoking_amount" name="smoking_amount" step="1">
        </div>
      </div>

      <!-- 과거 흡연 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">과거 흡연 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="smoking_past_yes" name="smoking_past" value="yes" required>
            <label class="form-check-label" for="smoking_past_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="smoking_past_no" name="smoking_past" value="no" required>
            <label class="form-check-label" for="smoking_past_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 당뇨병 병력 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">당뇨병 병력 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="diabetes_yes" name="diabetes" value="yes" required>
            <label class="form-check-label" for="diabetes_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="diabetes_no" name="diabetes" value="no" required>
            <label class="form-check-label" for="diabetes_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 심혈관 질환 병력 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">심혈관 질환 병력 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="heart_disease_yes" name="heart_disease" value="yes" required>
            <label class="form-check-label" for="heart_disease_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="heart_disease_no" name="heart_disease" value="no" required>
            <label class="form-check-label" for="heart_disease_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 고혈압 병력 여부 -->
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">고혈압 병력 여부</label>
        <div class="col-sm-10">
          <div class="form-check">
            <input type="radio" class="form-check-input" id="hypertension_yes" name="hypertension" value="yes" required>
            <label class="form-check-label" for="hypertension_yes">예</label>
          </div>
          <div class="form-check">
            <input type="radio" class="form-check-input" id="hypertension_no" name="hypertension" value="no" required>
            <label class="form-check-label" for="hypertension_no">아니오</label>
          </div>
        </div>
      </div>

      <!-- 제출 버튼 -->
      <div class="card-footer">
        <button type="submit" class="btn btn-warning">제출</button>
      </div>
    </div>
    <!--end::Body-->
  </form>
  <!--end::Form-->
</div>
<!--end::Horizontal Form-->

<script>
  // 음주 여부에 따라 음주량 입력란 보이기/숨기기 + 필수 여부 설정
  document.querySelectorAll('input[name="alcohol"]').forEach((elem) => {
    elem.addEventListener('change', function () {
      const drinkingAmountInput = document.getElementById('drinking_amount');
      const drinkingAmountDiv = document.getElementById('drinking_amount_div');
      if (this.value === 'yes') {
        drinkingAmountDiv.style.display = 'block';
        drinkingAmountInput.required = true;
      } else {
        drinkingAmountDiv.style.display = 'none';
        drinkingAmountInput.required = false;
        drinkingAmountInput.value = '';
      }
    });
  });

  // 흡연 여부에 따라 흡연량 입력란 보이기/숨기기 + 필수 여부 설정
  document.querySelectorAll('input[name="smoking_now"]').forEach((elem) => {
    elem.addEventListener('change', function () {
      const smokingAmountInput = document.getElementById('smoking_amount');
      const smokingAmountDiv = document.getElementById('smoking_amount_div');
      if (this.value === 'yes') {
        smokingAmountDiv.style.display = 'block';
        smokingAmountInput.required = true;
      } else {
        smokingAmountDiv.style.display = 'none';
        smokingAmountInput.required = false;
        smokingAmountInput.value = '';
      }
    });
  });
</script>

{% endblock %}